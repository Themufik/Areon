{% extends 'main/base.html' %}

{% block title %}–ü—Ä–æ—Ñ–∏–ª—å {{ profile_user.username }}{% endblock %}

{% block extra_css %}
<style>
    .profile-header {
        background: white;
        padding: 2rem;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        display: flex;
        gap: 2rem;
        align-items: center;
        margin-bottom: 2rem;
    }
    
    .profile-avatar {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 3rem;
        color: white;
    }
    
    .profile-info h1 {
        margin-bottom: 0.5rem;
    }
    
    .profile-stats {
        display: flex;
        gap: 2rem;
        margin-top: 1rem;
    }
    
    .stat {
        text-align: center;
    }
    
    .stat-value {
        font-size: 1.5rem;
        font-weight: bold;
        color: #3498db;
    }
    
    .stat-label {
        font-size: 0.9rem;
        color: #666;
    }
    
    .tabs {
        display: flex;
        gap: 1rem;
        margin-bottom: 2rem;
        border-bottom: 2px solid #eee;
    }
    
    .tab {
        padding: 1rem 2rem;
        background: none;
        border: none;
        cursor: pointer;
        font-size: 1rem;
        color: #666;
        border-bottom: 2px solid transparent;
        margin-bottom: -2px;
    }
    
    .tab.active {
        color: #3498db;
        border-bottom-color: #3498db;
    }
    
    .tab-content {
        display: none;
    }
    
    .tab-content.active {
        display: block;
    }
    
    .course-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 2rem;
    }
    
    .course-card {
        background: white;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        overflow: hidden;
        transition: transform 0.3s;
        text-decoration: none;
        color: inherit;
        display: block;
    }
    
    .course-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 5px 20px rgba(0,0,0,0.15);
    }
    
    .course-card-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 1.5rem;
    }
    
    .course-card-body {
        padding: 1.5rem;
    }
    
    .no-content {
        text-align: center;
        padding: 3rem;
        color: #666;
    }
</style>
{% endblock %}

{% block content %}
<div class="profile-header">
    <div class="profile-avatar">
        {{ profile_user.username|first|upper }}
    </div>
    <div class="profile-info">
        <h1>{{ profile_user.username }}</h1>
        <p>{{ profile_user.profile.bio|default:"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –¥–æ–±–∞–≤–∏–ª –æ–ø–∏—Å–∞–Ω–∏–µ" }}</p>
        
        {% if user == profile_user %}
            <a href="{% url 'profile_edit' %}" class="btn" style="margin-top: 1rem;">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</a>
        {% endif %}
        
        <div class="profile-stats">
            <div class="stat">
                <div class="stat-value">{{ created_courses_count }}</div>
                <div class="stat-label">–°–æ–∑–¥–∞–Ω–æ –∫—É—Ä—Å–æ–≤</div>
            </div>
            <div class="stat">
                <div class="stat-value">{{ completed_courses_count }}</div>
                <div class="stat-label">–ó–∞–≤–µ—Ä—à–µ–Ω–æ –∫—É—Ä—Å–æ–≤</div>
            </div>
            <div class="stat">
                <div class="stat-value">{{ total_progress }}</div>
                <div class="stat-label">–£—Ä–æ–∫–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ</div>
            </div>
        </div>
    </div>
</div>

<div class="tabs">
    <button class="tab active" onclick="showTab('created')">üìö –ú–æ–∏ –∫—É—Ä—Å—ã</button>
    <button class="tab" onclick="showTab('progress')">üìñ –ü—Ä–æ—Ö–æ–∂—É —Å–µ–π—á–∞—Å</button>
    <button class="tab" onclick="showTab('completed')">‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ</button>
</div>

<div id="created" class="tab-content active">
    {% if created_courses %}
        <div class="course-grid">
            {% for course in created_courses %}
                <a href="{% url 'course_detail' course.id %}" class="course-card">
                    <div class="course-card-header">
                        <h3>{{ course.name }}</h3>
                    </div>
                    <div class="course-card-body">
                        <p>{{ course.description|truncatewords:15 }}</p>
                        <div style="margin-top: 1rem; color: #666;">
                            üìñ {{ course.get_total_lessons }} —É—Ä–æ–∫–æ–≤
                        </div>
                    </div>
                </a>
            {% endfor %}
        </div>
    {% else %}
        <div class="no-content">
            <h2>üìù –í—ã –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–ª–∏ –Ω–∏ –æ–¥–Ω–æ–≥–æ –∫—É—Ä—Å–∞</h2>
            {% if user == profile_user %}
                <a href="{% url 'course_create' %}" class="btn" style="margin-top: 1rem;">–°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—ã–π –∫—É—Ä—Å</a>
            {% endif %}
        </div>
    {% endif %}
</div>

<div id="progress" class="tab-content">
    {% if in_progress_courses %}
        <div class="course-grid">
            {% for course in in_progress_courses %}
                <a href="{% url 'course_detail' course.id %}" class="course-card">
                    <div class="course-card-header">
                        <h3>{{ course.name }}</h3>
                    </div>
                    <div class="course-card-body">
                        <p>{{ course.description|truncatewords:15 }}</p>
                        <div style="margin-top: 1rem;">
                            <div style="background: #eee; height: 10px; border-radius: 5px; overflow: hidden;">
                                <div style="background: #27ae60; height: 100%; width: {{ course.progress_percent }}%;"></div>
                            </div>
                            <div style="margin-top: 0.5rem; color: #666; font-size: 0.9rem;">
                                –ü—Ä–æ–≥—Ä–µ—Å—Å: {{ course.progress_percent }}%
                            </div>
                        </div>
                    </div>
                </a>
            {% endfor %}
        </div>
    {% else %}
        <div class="no-content">
            <h2>üéØ –í—ã –ø–æ–∫–∞ –Ω–µ –Ω–∞—á–∞–ª–∏ –Ω–∏ –æ–¥–Ω–æ–≥–æ –∫—É—Ä—Å–∞</h2>
            <a href="{% url 'course_list' %}" class="btn" style="margin-top: 1rem;">–ù–∞–π—Ç–∏ –∫—É—Ä—Å</a>
        </div>
    {% endif %}
</div>

<div id="completed" class="tab-content">
    {% if completed_courses %}
        <div class="course-grid">
            {% for course in completed_courses %}
                <a href="{% url 'course_detail' course.id %}" class="course-card">
                    <div class="course-card-header">
                        <h3>{{ course.name }}</h3>
                        <span style="float: right;">‚úÖ</span>
                    </div>
                    <div class="course-card-body">
                        <p>{{ course.description|truncatewords:15 }}</p>
                    </div>
                </a>
            {% endfor %}
        </div>
    {% else %}
        <div class="no-content">
            <h2>üèÜ –í—ã –ø–æ–∫–∞ –Ω–µ –∑–∞–≤–µ—Ä—à–∏–ª–∏ –Ω–∏ –æ–¥–Ω–æ–≥–æ –∫—É—Ä—Å–∞</h2>
            <p>–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —É—á–∏—Ç—å—Å—è!</p>
        </div>
    {% endif %}
</div>

{% endblock %}

{% block extra_js %}
<script>
function showTab(tabName) {
    // –°–∫—Ä—ã—Ç—å –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
    const contents = document.querySelectorAll('.tab-content');
    contents.forEach(content => content.classList.remove('active'));
    
    // –£–±—Ä–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
    const tabs = document.querySelectorAll('.tab');
    tabs.forEach(tab => tab.classList.remove('active'));
    
    // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
    document.getElementById(tabName).classList.add('active');
    
    // –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–∂–∞—Ç—É—é –∫–Ω–æ–ø–∫—É
    event.target.classList.add('active');
}
</script>
{% endblock %}